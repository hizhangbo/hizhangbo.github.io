<!DOCTYPE HTML>
<html>
	<head>
        <title>Bob’s Blog</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="https://cdn.bootcss.com/html5shiv/3.6.2/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
		<script>
			var _hmt = _hmt || [];
			(function() {
			  var hm = document.createElement("script");
			  hm.src = "https://hm.baidu.com/hm.js?62888767648ab0a78f7107ed1f6dc242";
			  var s = document.getElementsByTagName("script")[0]; 
			  s.parentNode.insertBefore(hm, s);
			})();
		</script>
		<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
	</head>
	<body oncontextmenu="return false;" onselectstart="return false">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
                <header id="header">
    <h1><a href="/index.html">記憶 備份</a></h1>
    <nav class="links">
        <ul>
            <li><a href="/#about">關於我</a></li>
        </ul>
    </nav>
    <nav class="main">
        <ul>
            <!-- <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <input type="text" name="query" placeholder="Search" />
                <div></div>
            </li> -->
            <li class="light">
                <input type="checkbox" class="checke">
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>


    </nav>
</header>

                <!-- Menu -->
                <section id="menu">

    <!-- Search -->
        <section>
            <form class="search" method="get" action="#">
                <input type="text" name="query" placeholder="Search" id="search-input" />
            </form>
        </section>

        <section>
            <div id="results-container"></div>
        </section>
</section>


                <!-- Main -->
                <div id="main">
    <!-- Post -->
    <article class="post">
        <h1 id="mysql">Mysql</h1>
<hr />

<h3 id="性能監控指标">性能監控指标</h3>
<ul>
  <li>QPS
    <ul>
      <li>queries per second 每秒查询数量</li>
      <li><code class="highlighter-rouge">show global status like 'Question%';</code></li>
      <li>QPS = queries/seconds</li>
    </ul>
  </li>
  <li>TPS
    <ul>
      <li>Transaction per second</li>
      <li><code class="highlighter-rouge">show global status like 'Com_commit';</code></li>
      <li><code class="highlighter-rouge">show global status like 'Com_rollback';</code></li>
      <li>TPS = (Com_commit + Com_rollback)/seconds</li>
    </ul>
  </li>
  <li>连接数
    <ul>
      <li><code class="highlighter-rouge">show global status like 'Max_used_connections';</code></li>
      <li><code class="highlighter-rouge">show global status like 'Threads%';</code></li>
      <li><code class="highlighter-rouge">show variables like 'max_connections';</code></li>
    </ul>
  </li>
  <li>Query Cache
    <ul>
      <li>數據改動較少場景</li>
      <li>my.cnf參數修改 <code class="highlighter-rouge">query_cache_size</code></li>
      <li><code class="highlighter-rouge">show status like 'Qcache%';</code></li>
      <li>Query_cache_hits = (Qcache_hits/(Qcache_hits+Qcache_inserts)) * 100%</li>
    </ul>
  </li>
  <li>Lock
    <ul>
      <li><code class="highlighter-rouge">show global status like '%lock%';</code></li>
      <li>Table_locks_waited/Table_locks_immediate 值越大表示鎖造成的阻塞越嚴重</li>
      <li>Innodb 中間隙鎖造成 Innodb_row_lock_waits 太大</li>
    </ul>
  </li>
  <li>主從延時
    <ul>
      <li><code class="highlighter-rouge">show slave status;</code></li>
    </ul>
  </li>
  <li>慢查詢
    <ul>
      <li>my.cnf參數修改 [mysqld] <code class="highlighter-rouge">slow_query_log=1</code></li>
      <li>慢查詢日志地址<code class="highlighter-rouge">slow_query_log_file=/data/mysql/slow.log</code></li>
      <li>慢查詢時長<code class="highlighter-rouge">long_query_time=1</code></li>
      <li>未使用索引的查詢 <code class="highlighter-rouge">log_queries_not_using_indexes=1</code></li>
      <li><code class="highlighter-rouge">mysqldumpslow -s c -t 10 slow.log</code> # 返回使用最多的10條</li>
      <li><code class="highlighter-rouge">mysqldumpslow -s r -t 10 slow.log</code> # 返回結果最多的10條</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="jmeter配置">Jmeter配置</h3>


    </article>
    <div id="vcomments"></div>
    <!-- Pagination -->
    <ul class="actions pagination">
        
        <li><a class="disabled button big previous">Previous</a></li>
        

        
        <li><a class="disabled button big next">Next</a></li>
        
        <li id="/mysql/2020-02-11-mysql.html" class="leancloud_visitors" style="float: right;"><a class="icon fa-eye leancloud-visitors-count" aria-hidden="true"></a></li>
    </ul>
</div>

<script>
    new Valine({
        el: '#vcomments' ,
        appId: 'VDYHbJKU0wCisABJmYCE1jaY-gzGzoHsz',
        appKey: '1CSpcPFQ88n8LBW7SjpAbMIc',
        notify:false, 
        verify:false, 
        avatar:'mp', 
        placeholder: '若有疏失，還望指正',
        visitor: true,
        recordIP: true
    });
</script>

			</div>
		<div id="leftsead">
    <ul>
        <li class="top">
            ↑
        </li>
        <li class="bottom">
            ↑
        </li>
    </ul>
</div>

		<!-- Scripts -->
        <script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.bootcss.com/skel/3.0.0/skel.min.js"></script>
<script src="/assets/js/util.js"></script>
<!--[if lte IE 8]><script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script><![endif]-->
<script src="/assets/js/main.js"></script>
<script src="/assets/js/search.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'VDYHbJKU0wCisABJmYCE1jaY-gzGzoHsz',
        appKey: '1CSpcPFQ88n8LBW7SjpAbMIc'
    })
</script>

	</body>
</html>
